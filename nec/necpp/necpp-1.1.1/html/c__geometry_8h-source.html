<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>nec++: c_geometry.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a></div>
<h1>c_geometry.h</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">        Copyright (C) 2004  Timothy C.A. Molteno</span>
00003 <span class="comment">        </span>
00004 <span class="comment">        This program is free software; you can redistribute it and/or modify</span>
00005 <span class="comment">        it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment">        the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment">        (at your option) any later version.</span>
00008 <span class="comment">        </span>
00009 <span class="comment">        This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment">        but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment">        GNU General Public License for more details.</span>
00013 <span class="comment">        </span>
00014 <span class="comment">        You should have received a copy of the GNU General Public License</span>
00015 <span class="comment">        along with this program; if not, write to the Free Software</span>
00016 <span class="comment">        Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00017 <span class="comment">*/</span>
00018 <span class="preprocessor">#ifndef __c_geometry__</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#define __c_geometry__</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#include "math_util.h"</span>
00021 
00022 <span class="comment">/* Replaces the "10000" limit used to */</span>
00023 <span class="comment">/* identify segment/patch connections */</span>
00024 <span class="preprocessor">#define PCHCON  100000</span>
00025 <span class="preprocessor"></span>
00026 <span class="keyword">class </span><a class="code" href="classnec__context.html">nec_context</a>;
00027 <span class="preprocessor">#include "nec_output.h"</span>
00028 
00029 <span class="comment">/*</span>
00030 <span class="comment">        Use of the c_geometry class.</span>
00031 <span class="comment">        </span>
00032 <span class="comment">                c_geometry g = new c_geometry();</span>
00033 <span class="comment">                g.parse_geometry(file);</span>
00034 <span class="comment">                </span>
00035 <span class="comment">        OR</span>
00036 <span class="comment">        </span>
00037 <span class="comment">                c_geometry g = new c_geometry();</span>
00038 <span class="comment">                g.wire(xxxxxxx);</span>
00039 <span class="comment">                g.arc();</span>
00040 <span class="comment">                ...</span>
00041 <span class="comment">                g.geometry_complete();          </span>
00042 <span class="comment"></span>
00043 <span class="comment">*/</span>
00044 <span class="keyword">class </span>c_geometry
00045 {
00046 <span class="keyword">public</span>:
00047         c_geometry();
00048         <span class="keywordtype">void</span> set_context(<a class="code" href="classnec__context.html">nec_context</a>* m_context);
00049         
00050         <span class="keywordtype">void</span> wire(      <span class="keywordtype">int</span> tag_id, <span class="keywordtype">int</span> segment_count,
00051                         nec_float xw1, nec_float yw1, nec_float zw1,    <span class="comment">// first co-ordinate</span>
00052                         nec_float xw2, nec_float yw2, nec_float zw2,    <span class="comment">// second co-ordinate</span>
00053                         nec_float rad,                                  <span class="comment">// wire radius (=0 if tapered)</span>
00054                         nec_float rdel, nec_float rrad);                <span class="comment">// set to 1.0 if not tapered</span>
00055                         
00056                         
00057         <span class="keywordtype">void</span> arc( <span class="keywordtype">int</span> tag_id, <span class="keywordtype">int</span> segment_count, nec_float rada,
00058                         nec_float ang1, nec_float ang2, nec_float rad );
00059                         
00060         <span class="keywordtype">void</span> helix( nec_float s, nec_float hl, nec_float a1, nec_float b1,
00061                         nec_float a2, nec_float b2, nec_float rad, <span class="keywordtype">int</span> segment_count, <span class="keywordtype">int</span> tag_id );
00062         
00063         <span class="keywordtype">void</span> move( nec_float rox, nec_float roy, nec_float roz, nec_float xs,
00064                         nec_float ys, nec_float zs, <span class="keywordtype">int</span> its, <span class="keywordtype">int</span> nrpt, <span class="keywordtype">int</span> itgi );
00065 
00066         <span class="keywordtype">void</span> reflect( <span class="keywordtype">int</span> ix, <span class="keywordtype">int</span> iy, <span class="keywordtype">int</span> iz, <span class="keywordtype">int</span> itx, <span class="keywordtype">int</span> nop );
00067 
00068         <span class="keywordtype">void</span> patch( <span class="keywordtype">int</span> nx, <span class="keywordtype">int</span> ny,
00069                         nec_float ax1, nec_float ay1, nec_float az1,
00070                         nec_float ax2, nec_float ay2, nec_float az2,
00071                         nec_float ax3, nec_float ay3, nec_float az3,
00072                         nec_float ax4, nec_float ay4, nec_float az4 );
00073         
00074         
00078         <span class="keywordtype">void</span> geometry_complete(<a class="code" href="classnec__context.html">nec_context</a>* m_context, <span class="keywordtype">int</span> card_int_1, <span class="keywordtype">int</span> card_int_2);
00079         
00080         
00081         
00085         <span class="keywordtype">void</span> parse_geometry(<a class="code" href="classnec__context.html">nec_context</a>* m_context, FILE* input_fp);
00086 
00087         
00088         <span class="keywordtype">int</span> get_segment_number( <span class="keywordtype">int</span> in_tag, <span class="keywordtype">int</span> m);
00089 
00090         
00091         <span class="keywordtype">void</span> frequency_scale(nec_float freq_mhz, <a class="code" href="classsafe__array.html">real_array</a>&amp; xtemp, <a class="code" href="classsafe__array.html">real_array</a>&amp; ytemp,
00092                         <a class="code" href="classsafe__array.html">real_array</a>&amp; ztemp, <a class="code" href="classsafe__array.html">real_array</a>&amp; sitemp, <a class="code" href="classsafe__array.html">real_array</a>&amp; bitemp);
00093 
00094         <span class="keywordtype">void</span> fill_temp_geom(<span class="keywordtype">int</span> *ifrtmw, <span class="keywordtype">int</span> *ifrtmp, <a class="code" href="classsafe__array.html">real_array</a>&amp; xtemp, 
00095                         <a class="code" href="classsafe__array.html">real_array</a>&amp; ytemp, <a class="code" href="classsafe__array.html">real_array</a>&amp; ztemp, <a class="code" href="classsafe__array.html">real_array</a>&amp; sitemp, 
00096                         <a class="code" href="classsafe__array.html">real_array</a>&amp; bitemp);
00097                 
00098         <span class="keywordtype">void</span> tbf( <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> icap);
00099         <span class="keywordtype">void</span> trio( <span class="keywordtype">int</span> j );
00100         
00101         <span class="keywordtype">void</span> get_current_coefficients(nec_float wavelength, <a class="code" href="classsafe__array.html">complex_array</a>&amp; curx,
00102                         <a class="code" href="classsafe__array.html">real_array</a>&amp; air, <a class="code" href="classsafe__array.html">real_array</a>&amp; aii,
00103                         <a class="code" href="classsafe__array.html">real_array</a>&amp; bir, <a class="code" href="classsafe__array.html">real_array</a>&amp; bii,
00104                         <a class="code" href="classsafe__array.html">real_array</a>&amp; cir, <a class="code" href="classsafe__array.html">real_array</a>&amp; cii,
00105                         <a class="code" href="classsafe__array.html">complex_array</a>&amp; vqds, <span class="keywordtype">int</span> nqds,
00106                         <a class="code" href="classsafe__array.html">int_array</a>&amp; iqds);
00107         
00108         nec_float patch_angle(<span class="keywordtype">int</span> patch_index, nec_float ax, nec_float ay, nec_float az)
00109         {
00110                 <span class="keywordflow">return</span> two_pi()*(ax*px[patch_index]+ ay*py[patch_index]+ az*pz[patch_index]);
00111         }
00112         
00116         <span class="keywordtype">void</span> fflds(nec_float rox, nec_float roy, nec_float roz,
00117                 <a class="code" href="classsafe__array.html">complex_array</a>&amp; scur, 
00118                 nec_complex *in_ex, nec_complex *in_ey, nec_complex *in_ez )
00119         {
00120                 <span class="keyword">static</span> nec_complex _const4(0.0,+188.365);
00121                 
00122                 <span class="comment">// From FORTRAN common block </span>
00123                 <span class="comment">// EQUIVALENCE (XS,X), (YS,Y), (ZS,Z), (S,BI), (CONS,CONSX)</span>
00124                 nec_complex ex(cplx_00());
00125                 nec_complex ey(cplx_00());
00126                 nec_complex ez(cplx_00());
00127                 
00128                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m; i++ )
00129                 {
00130                         nec_float arg = patch_angle(i,rox,roy,roz);
00131                         nec_complex ct = cplx_exp(arg) * pbi[i];
00132                         <span class="keywordtype">int</span> k = 3*i;
00133                         ex += scur[k]* ct;
00134                         ey += scur[k+1]* ct;
00135                         ez += scur[k+2]* ct;
00136                 }
00137                 
00138                 nec_complex ct = rox*ex+ roy*ey+ roz*ez;
00139                 
00140                 *in_ex = _const4*(ct*rox - ex);
00141                 *in_ey = _const4*(ct*roy - ey);
00142                 *in_ez = _const4*(ct*roz - ez);
00143         }
00144 
00145                 
00146         <span class="keywordtype">int</span> n, np; <span class="comment">// n is the number of segments</span>
00147         <a class="code" href="classsafe__array.html">int_array</a> segment_tags;
00148         <a class="code" href="classsafe__array.html">real_array</a> x, y, z, segment_length, bi;
00149         <a class="code" href="classsafe__array.html">real_array</a> x2, y2, z2, cab, sab, salp;
00150         
00151         <span class="keywordtype">int</span> m, mp;      <span class="comment">// m is the number of patches?</span>
00152         <span class="keywordtype">int</span> m_ipsym;
00153         
00154         <a class="code" href="classsafe__array.html">real_array</a> t1x, t1y, t1z, t2x, t2y, t2z;        <span class="comment">// t1, t2 basis co-ordinates?</span>
00155         <a class="code" href="classsafe__array.html">real_array</a> px, py, pz, pbi, psalp;                      <span class="comment">// patch data</span>
00156 
00157         <span class="keywordtype">int</span> n_plus_m, n_plus_2m, n_plus_3m; <span class="comment">/* n+m,n+2m,n+3m */</span>
00158         
00159         <a class="code" href="classsafe__array.html">int_array</a> icon1, icon2;
00160         <span class="comment">// Connected Segment Information (was common  /segj/  in FORTRAN code)</span>
00161         <span class="keywordtype">int</span> jsno, nscon, maxcon; <span class="comment">/* Max. no. connections */</span>
00162         <a class="code" href="classsafe__array.html">int_array</a> jco;
00163         <a class="code" href="classsafe__array.html">real_array</a> ax, bx, cx;
00164                 
00165 <span class="keyword">private</span>:
00166         <span class="keywordtype">void</span> sbf( <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> is, nec_float *aa, nec_float *bb, nec_float *cc );
00167         
00168 
00169         <span class="keywordtype">void</span> subph( <span class="keywordtype">int</span> nx, <span class="keywordtype">int</span> ny );
00170 
00171         <span class="keywordtype">void</span> connect_segments( <span class="keywordtype">int</span> ignd );
00172 
00173         <span class="keywordtype">void</span> read_geometry_card(FILE* input_fp, <span class="keywordtype">char</span> *gm,
00174                 <span class="keywordtype">int</span> *i1, <span class="keywordtype">int</span> *i2, 
00175                 nec_float *x1, nec_float *y1,nec_float *z1,
00176                 nec_float *x2, nec_float *y2, nec_float *z2, 
00177                 nec_float *rad );
00178 
00179         FILE *m_output_fp;
00180         <a class="code" href="classnec__context.html">nec_context</a>* m_context;
00181         nec_output_file* m_output;
00182 };
00183 
00184 <span class="preprocessor">#endif </span><span class="comment">/* __c_geometry__ */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Nov 23 11:15:16 2004 for nec++ by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
